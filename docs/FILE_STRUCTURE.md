# é¡¹ç›®æ–‡ä»¶ç»“æ„è¯´æ˜

## ğŸ“ ç›®å½•ç»“æ„

```
viajes-fh-main/
â”œâ”€â”€ index.html                    # ä¸»HTMLæ–‡ä»¶
â”œâ”€â”€ favicon.ico                   # ç½‘ç«™å›¾æ ‡
â”‚
â”œâ”€â”€ css/                          # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ style.css                # ä¸»æ ·å¼è¡¨
â”‚
â”œâ”€â”€ js/                           # JavaScriptæ–‡ä»¶
â”‚   â”œâ”€â”€ core/                    # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ utils.js            # é€šç”¨å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ firebase-config.js  # Firebaseé…ç½®
â”‚   â”‚   â””â”€â”€ i18n.js             # å¤šè¯­è¨€æ ¸å¿ƒ
â”‚   â”‚
â”‚   â”œâ”€â”€ modes/                   # æ¨¡å¼æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ bill-mode.js        # è´¦å•æ¨¡å¼ï¼ˆB2Bå†…éƒ¨è´¦å•ï¼‰
â”‚   â”‚   â”œâ”€â”€ quote-mode.js       # æŠ¥ä»·æ¨¡å¼ï¼ˆB2Cå®¢æˆ·æŠ¥ä»·ï¼‰
â”‚   â”‚   â”œâ”€â”€ ticket-mode.js      # ç¥¨æ®æ¨¡å¼ï¼ˆæ”¯ä»˜å‡­è¯ï¼‰
â”‚   â”‚   â””â”€â”€ compare-mode.js     # å¯¹æ¯”æ¨¡å¼ï¼ˆä»·æ ¼å¯¹æ¯”åˆ†æï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ main.js                  # ä¸»å…¥å£æ–‡ä»¶ï¼ˆåè°ƒå„æ¨¡å¼ï¼‰
â”‚
â”œâ”€â”€ data/                         # æ•°æ®æ–‡ä»¶
â”‚   â”œâ”€â”€ config.json              # å…¨å±€é…ç½®
â”‚   â”œâ”€â”€ bill-data.json           # è´¦å•æ¨¡å¼æ•°æ®
â”‚   â”œâ”€â”€ quote-data.json          # æŠ¥ä»·æ¨¡å¼æ•°æ®
â”‚   â”œâ”€â”€ ticket-data.json         # ç¥¨æ®æ¨¡å¼æ•°æ®
â”‚   â””â”€â”€ compare-data.json        # å¯¹æ¯”æ¨¡å¼æ•°æ®
â”‚
â””â”€â”€ docs/                         # æ–‡æ¡£ç›®å½•
    â”œâ”€â”€ README.md
    â”œâ”€â”€ CONFIG_EXTERNALIZED.md
    â”œâ”€â”€ DUAL_MODE_UPDATE.md
    â””â”€â”€ ...ï¼ˆæ‰€æœ‰MDæ–‡æ¡£ï¼‰
```

## ğŸ¯ æ¨¡å—è¯´æ˜

### æ ¸å¿ƒæ¨¡å—ï¼ˆjs/core/ï¼‰

#### utils.js
é€šç”¨å·¥å…·å‡½æ•°ï¼ŒåŒ…æ‹¬ï¼š
- `formatMoney()` - é‡‘é¢æ ¼å¼åŒ–
- `checkClear()` - è¾“å…¥æ¡†æ¸…é™¤æŒ‰é’®é€»è¾‘
- `clearField()` - æ¸…é™¤å­—æ®µ
- `syncState()` - FirebaseåŒæ­¥
- `loadJSON()` - åŠ è½½JSONæ•°æ®
- `formatDate()` - æ—¥æœŸæ ¼å¼åŒ–

#### firebase-config.js
Firebaseåˆå§‹åŒ–å’Œé…ç½®

#### i18n.js
å¤šè¯­è¨€æ”¯æŒï¼ˆä¸­æ–‡ã€è¥¿ç­ç‰™è¯­ã€è‹±è¯­ï¼‰

### æ¨¡å¼æ¨¡å—ï¼ˆjs/modes/ï¼‰

æ¯ä¸ªæ¨¡å¼æ–‡ä»¶åŒ…å«ï¼š
- `init()` - åˆå§‹åŒ–æ¨¡å¼ï¼ŒåŠ è½½å¯¹åº”çš„JSONæ•°æ®
- `activate()` - æ¿€æ´»æ¨¡å¼ï¼Œæ˜¾ç¤ºç›¸å…³UIå…ƒç´ 
- `deactivate()` - åœç”¨æ¨¡å¼ï¼Œéšè—ç›¸å…³UIå…ƒç´ 
- æ¨¡å¼ç‰¹å®šçš„ä¸šåŠ¡é€»è¾‘

#### bill-mode.jsï¼ˆè´¦å•æ¨¡å¼ï¼‰
- B2Bå†…éƒ¨è´¦å•
- æ˜¾ç¤ºä½£é‡‘ã€åº•ä»·ã€å‡€ä»·ç­‰æ•æ„Ÿä¿¡æ¯
- å®Œæ•´çš„æˆæœ¬ç»“ç®—

#### quote-mode.jsï¼ˆæŠ¥ä»·æ¨¡å¼ï¼‰
- B2Cå®¢æˆ·æŠ¥ä»·
- éšè—æ•æ„Ÿä¿¡æ¯ï¼ˆä½£é‡‘ã€åº•ä»·ï¼‰
- å®¢æˆ·å‹å¥½çš„ä»·æ ¼å±•ç¤º

#### ticket-mode.jsï¼ˆç¥¨æ®æ¨¡å¼ï¼‰
- æ”¯ä»˜å‡­è¯
- è·Ÿè¸ªå·²ä»˜/å¾…ä»˜é‡‘é¢
- æ”¯ä»˜çŠ¶æ€ç®¡ç†

#### compare-mode.jsï¼ˆå¯¹æ¯”æ¨¡å¼ï¼‰
- è¥¿åŒº/å¾·åŒºä»·æ ¼å¯¹æ¯”
- ä¼šå‘˜ä»·æ ¼ï¼ˆClubã€Selectionï¼‰
- æˆæœ¬è®¡ç®—å’Œåˆ©æ¶¦åˆ†æ

## ğŸ“Š æ•°æ®æ–‡ä»¶ï¼ˆdata/ï¼‰

æ¯ä¸ªæ¨¡å¼æœ‰ç‹¬ç«‹çš„JSONæ•°æ®æ–‡ä»¶ï¼š

### bill-data.json
```json
{
  "mode": "bill",
  "defaults": {
    "showCommission": true,
    "showBaseFare": true,
    "showNetPayable": true
  },
  "savedDrafts": []
}
```

### quote-data.json
```json
{
  "mode": "quote",
  "defaults": {
    "showCommission": false,
    "hideClientRates": true
  },
  "savedQuotes": []
}
```

### ticket-data.json
```json
{
  "mode": "ticket",
  "defaults": {
    "showPaidAmount": true,
    "showPendingAmount": true
  },
  "savedTickets": []
}
```

### compare-data.json
```json
{
  "mode": "compare",
  "defaults": {
    "regions": ["west", "german"],
    "showClubDiscount": true,
    "showProfitAnalysis": true
  },
  "savedComparisons": []
}
```

## ğŸ”§ å¦‚ä½•æ·»åŠ æ–°åŠŸèƒ½

### ä¸ºç‰¹å®šæ¨¡å¼æ·»åŠ åŠŸèƒ½

1. æ‰“å¼€å¯¹åº”çš„æ¨¡å¼æ–‡ä»¶ï¼ˆå¦‚ `js/modes/compare-mode.js`ï¼‰
2. åœ¨æ¨¡å—å¯¹è±¡ä¸­æ·»åŠ æ–°æ–¹æ³•
3. æ›´æ–°å¯¹åº”çš„JSONæ•°æ®æ–‡ä»¶ï¼ˆå¦‚éœ€è¦ï¼‰

### æ·»åŠ æ–°çš„é€šç”¨åŠŸèƒ½

1. åœ¨ `js/core/utils.js` ä¸­æ·»åŠ é€šç”¨å‡½æ•°
2. é€šè¿‡ `window.functionName` å¯¼å‡ºåˆ°å…¨å±€

### ä¿®æ”¹æŸä¸ªæ¨¡å¼çš„æ•°æ®ç»“æ„

1. ç¼–è¾‘å¯¹åº”çš„JSONæ–‡ä»¶ï¼ˆå¦‚ `data/compare-data.json`ï¼‰
2. æ›´æ–°æ¨¡å¼JSæ–‡ä»¶ä¸­çš„æ•°æ®å¤„ç†é€»è¾‘

## ğŸ“ æ–‡æ¡£ç®¡ç†

æ‰€æœ‰MDæ–‡æ¡£å·²æ•´ç†åˆ° `docs/` ç›®å½•ï¼š
- æŠ€æœ¯æ–‡æ¡£
- æ›´æ–°æ—¥å¿—
- åŠŸèƒ½è¯´æ˜
- é…ç½®æŒ‡å—

## ğŸš€ åŠ è½½é¡ºåº

index.htmlä¸­çš„è„šæœ¬æŒ‰ä»¥ä¸‹é¡ºåºåŠ è½½ï¼š

1. **æ ¸å¿ƒæ¨¡å—**ï¼ˆæŒ‰é¡ºåºï¼‰
   - utils.js
   - firebase-config.js
   - i18n.js

2. **æ¨¡å¼æ¨¡å—**ï¼ˆå¹¶è¡ŒåŠ è½½ï¼‰
   - bill-mode.js
   - quote-mode.js
   - ticket-mode.js
   - compare-mode.js

3. **ä¸»ç¨‹åº**
   - main.js

## ğŸ’¡ æœ€ä½³å®è·µ

1. **æ¨¡å¼ç‹¬ç«‹æ€§**ï¼šæ¯ä¸ªæ¨¡å¼çš„é€»è¾‘åº”è‡ªåŒ…å«åœ¨å…¶æ¨¡å—æ–‡ä»¶ä¸­
2. **æ•°æ®åˆ†ç¦»**ï¼šæ¯ä¸ªæ¨¡å¼çš„é…ç½®å’Œæ•°æ®å­˜å‚¨åœ¨ç‹¬ç«‹çš„JSONæ–‡ä»¶
3. **å…±äº«é€»è¾‘**ï¼šé€šç”¨å‡½æ•°æ”¾åœ¨ `utils.js`
4. **æ–‡æ¡£æ•´ç†**ï¼šæŠ€æœ¯æ–‡æ¡£ç»Ÿä¸€æ”¾åœ¨ `docs/` ç›®å½•

## âš ï¸ æ³¨æ„äº‹é¡¹

1. ä¿®æ”¹æ¨¡å¼åŠŸèƒ½æ—¶ï¼Œåªéœ€ç¼–è¾‘å¯¹åº”çš„ `modes/*.js` æ–‡ä»¶
2. æ·»åŠ æ–°çš„æ¨¡å¼æ•°æ®æ—¶ï¼Œåˆ›å»ºæ–°çš„ `data/*-data.json` æ–‡ä»¶
3. æ–‡æ¡£æ›´æ–°åœ¨ `docs/` ç›®å½•è¿›è¡Œï¼Œä¸å½±å“ä»£ç ç»“æ„
4. `main.js` è´Ÿè´£åè°ƒå„æ¨¡å¼ï¼Œé¿å…åœ¨æ¨¡å¼æ–‡ä»¶ä¸­äº’ç›¸å¼•ç”¨
