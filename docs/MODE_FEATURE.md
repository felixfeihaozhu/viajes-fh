# 🔄 双模式功能说明

## 📋 功能概述

系统现在支持两种显示模式，可以随时切换：

### 1. **账单模式** (Bill Mode) - 默认模式
- **适用对象**：批发客户、旅行社、分销商 (B2B)
- **显示内容**：完整的账单信息，包括佣金、底价、结算价等批发细节

### 2. **报价模式** (Quote Mode) - 新增
- **适用对象**：散客、直客、终端消费者 (B2C)
- **显示内容**：简化版报价单，只显示最终价格，隐藏批发信息

---

## 🎯 使用场景

### 账单模式 📊
```
✅ 给旅行社出账单
✅ 分销商结算
✅ 内部财务核算
✅ 显示完整佣金信息
```

### 报价模式 💰
```
✅ 给终端客户报价
✅ B2C 直销
✅ 对外展示价格
✅ 隐藏批发利润信息
```

---

## 🔧 如何使用

### 切换模式

在顶部工具栏左侧，点击相应的模式按钮：

1. **账单模式** - 蓝色图标，显示完整账单
2. **报价模式** - 紫色图标，显示简化报价

模式选择会自动保存，下次打开时保持上次的选择。

---

## 📊 两种模式的区别

### 账单模式显示的内容：

| 列名 | 说明 | 是否显示 |
|------|------|----------|
| 舱房说明 | 舱房类型和描述 | ✅ 显示 |
| 人数/数量 | PAX 数量 | ✅ 显示 |
| **直客价** | Gross Price | ✅ 显示 |
| **净船票** | Base Fare | ✅ 显示 |
| **佣金** | Commission | ✅ 显示 |
| 税费 | Tax | ✅ 显示 |
| 服务费 | HSC | ✅ 显示 |
| **结算价** | Net Payable | ✅ 显示 |

**总计部分：**
- ✅ 直客总价
- ✅ 税费服务费总额
- ✅ **净船票总价**
- ✅ **减：佣金**
- ✅ **实付结算价**

**表单编辑区：**
- ✅ **佣金比例输入框**
- ✅ **附加佣金比例输入框**

---

### 报价模式显示的内容：

| 列名 | 说明 | 是否显示 |
|------|------|----------|
| 舱房说明 | 舱房类型和描述 | ✅ 显示 |
| 人数/数量 | PAX 数量 | ✅ 显示 |
| **直客价** | Gross Price | ✅ 显示 |
| ~~净船票~~ | ~~Base Fare~~ | ❌ **隐藏** |
| ~~佣金~~ | ~~Commission~~ | ❌ **隐藏** |
| 税费 | Tax | ✅ 显示 |
| 服务费 | HSC | ✅ 显示 |
| ~~结算价~~ | ~~Net Payable~~ | ❌ **隐藏** |

**总计部分：**
- ✅ 直客总价
- ✅ 税费服务费总额
- ❌ ~~净船票总价~~ **隐藏**
- ❌ ~~减：佣金~~ **隐藏**
- ❌ ~~实付结算价~~ **隐藏**

**表单编辑区：**
- ❌ ~~佣金比例输入框~~ **隐藏**
- ❌ ~~附加佣金比例输入框~~ **隐藏**

---

## 💡 实际应用示例

### 场景 1：给旅行社出账单

**使用模式：** 账单模式 📊

```
舱房：Balcony / Fantastica / Basic
人数：2
直客价：€2,000
净船票：€1,600
佣金：-€400 (20% + 0)
税费：€200
服务费：€200
结算价：€1,600

实付结算价：€1,600
```

✅ 显示完整的佣金计算，便于旅行社核对结算

---

### 场景 2：给终端客户报价

**使用模式：** 报价模式 💰

```
舱房：Balcony / Fantastica / Basic
人数：2
直客价：€2,000
税费：€200
服务费：€200

总价：€2,000
```

✅ 只显示最终价格，客户看到的是干净、简洁的报价单

---

## 🎨 视觉效果

### 账单模式
- 蓝色高亮按钮
- 完整的 8 列表格
- 显示所有财务细节

### 报价模式
- 紫色高亮按钮
- 简化的 5 列表格
- 聚焦于最终价格

---

## 📱 多语言支持

两种模式都支持中文、西班牙语、英语三种语言：

### 中文
- 账单模式 / 报价模式

### 西班牙语
- Modo Factura / Modo Cotización

### 英语
- Bill Mode / Quote Mode

---

## 🔐 数据安全

- ✅ 切换模式**不会修改**任何数据
- ✅ 只是改变显示方式
- ✅ 所有计算逻辑保持不变
- ✅ 模式选择保存在本地，不会同步到云端

---

## ⚙️ 技术实现

### CSS 类控制
- `.bill-only` - 仅在账单模式显示的元素
- `.quote-mode` - 应用到文档根元素时激活报价模式
- `.quote-mode .bill-only { display: none !important; }` - 隐藏批发信息

### JavaScript 控制
```javascript
// 切换模式
switchMode('bill')  // 账单模式
switchMode('quote') // 报价模式

// 获取当前模式
getCurrentMode()    // 返回 'bill' 或 'quote'
```

### 本地存储
```javascript
localStorage.setItem('viewMode', 'quote')
localStorage.getItem('viewMode') // 读取模式
```

---

## 🚀 快速开始

1. **打开系统**
2. **点击顶部工具栏的模式切换按钮**
3. **选择合适的模式**：
   - 给旅行社出账单 → 选择"账单模式"
   - 给终端客户报价 → 选择"报价模式"
4. **编辑内容并打印/导出 PDF**

---

## 📝 注意事项

### ⚠️ 重要提示

1. **模式切换不影响数据**
   - 切换模式时，所有已输入的数据保持不变
   - 只是改变显示和隐藏某些列

2. **打印时保持当前模式**
   - 打印或导出 PDF 时，会按照当前选择的模式进行
   - 确保在打印前选择正确的模式

3. **模式会自动保存**
   - 关闭浏览器后再打开，会自动恢复上次的模式选择

4. **隐藏不等于删除**
   - 报价模式下，佣金等信息只是隐藏，并没有被删除
   - 随时可以切换回账单模式查看完整信息

---

## 🎯 最佳实践

### 推荐工作流程

1. **录入数据** - 在账单模式下录入完整信息
2. **内部核对** - 使用账单模式核对佣金、底价等
3. **对外报价** - 切换到报价模式，打印或导出给客户
4. **结算开票** - 切换回账单模式，打印完整账单给旅行社

### 快捷键建议（未来可实现）
```
Alt + 1  → 切换到账单模式
Alt + 2  → 切换到报价模式
```

---

## 🔄 版本历史

### v7.3.6 - 2025-12-06
- ✅ 新增双模式切换功能
- ✅ 支持账单模式和报价模式
- ✅ 模式选择自动保存
- ✅ 多语言支持（中英西）

---

## 📞 技术支持

如有问题或建议，请联系技术团队。

---

**版本：** 7.3.6  
**最后更新：** 2025-12-06  
**开发团队：** FH Global

---

**🎉 享受全新的双模式功能！**
