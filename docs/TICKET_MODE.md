# 🎫 票据模式功能说明

## ✅ 功能概述

新增**票据模式**，专门用于给已付款的客户打印票据。

---

## 🎯 三种模式对比

### 1. **账单模式** (Bill Mode) 📊
**适用对象：** 批发商、旅行社 (B2B)  
**显示内容：** 完整的账单信息，包括佣金、底价、结算价等批发细节

### 2. **报价模式** (Quote Mode) 💰
**适用对象：** 散客、直客 (B2C)  
**显示内容：** 简化版报价单，只显示最终价格，隐藏批发信息

### 3. **票据模式** (Ticket Mode) 🎫
**适用对象：** 已付款的客户  
**显示内容：** 票据信息，强调已付款状态，简洁明了

---

## 🎨 票据模式特色

### 1. **简洁明了**
- 保留核心信息（舱房、价格、税费等）
- 隐藏复杂的批发计算
- 突出"已付款"状态

### 2. **专业票据外观**
- 采用票据化设计风格
- 清晰的价格汇总
- 适合打印和存档

### 3. **多语言支持**
- 中文：票据 TICKET
- 西班牙语：TICKET
- 英语：TICKET

---

## 📋 票据模式显示内容

### 表格部分
| 列名 | 是否显示 | 说明 |
|------|----------|------|
| 舱房说明 | ✅ 显示 | Cabin Description |
| 人数/数量 | ✅ 显示 | PAX |
| 直客价 | ✅ 显示 | Gross Price |
| 税费 | ✅ 显示 | Tax |
| 服务费 | ✅ 显示 | HSC |
| ~~净船票~~ | ❌ 隐藏 | Base Fare |
| ~~佣金~~ | ❌ 隐藏 | Comm |
| ~~结算价~~ | ❌ 隐藏 | Net Payable |

### 总计部分
- ✅ 直客总价
- ✅ 税费服务费总额
- ❌ ~~净船票总价~~ (隐藏)
- ❌ ~~减：佣金~~ (隐藏)
- ❌ ~~实付结算价~~ (隐藏)

### 表单区域
- ❌ ~~佣金比例输入框~~ (隐藏)
- ❌ ~~附加佣金比例输入框~~ (隐藏)

---

## 🎯 使用场景

### 场景 1：客户已付款
```
1. 客户完成付款
2. 切换到票据模式 🎫
3. 打印票据给客户
4. 作为付款凭证存档
```

### 场景 2：财务存档
```
1. 月度结算完成后
2. 为每笔交易生成票据
3. 统一存档管理
4. 方便审计核查
```

### 场景 3：客户索要凭证
```
1. 客户要求提供付款凭证
2. 切换到票据模式
3. 打印清晰的票据
4. 标注"已付款"状态
```

---

## 🖨️ 打印效果

### 票据模式打印预览
```
┌─────────────────────────────────────────────┐
│ 🎫 票据 TICKET                              │
├─────────────────────────────────────────────┤
│ 舱房说明 │ PAX │ 直客价 │ 税费 │ HSC │
│ Balcony  │  2  │ 2,000 │ 200 │ 200 │
├─────────────────────────────────────────────┤
│ 直客总价：EUR 2,000                         │
│ 税费服务费总额：400                         │
└─────────────────────────────────────────────┘
```

### 与其他模式对比

| 模式 | 打印用途 | 信息复杂度 | 适用对象 |
|------|----------|------------|----------|
| **账单模式** | 结算凭证 | 复杂 | 旅行社 |
| **报价模式** | 价格咨询 | 简单 | 潜在客户 |
| **票据模式** | 付款凭证 | 简洁 | 已付款客户 |

---

## 🎛️ 模式切换

### 工具栏按钮
```
[账单] [报价] [票据] | [中] [ES] [EN] | [备份] [恢复] [重置] [打印]
```

### 切换方式
1. 点击工具栏的"票据"按钮
2. 系统立即切换到票据模式
3. 页面元素自动调整显示/隐藏
4. 标题更新为"票据 TICKET"

---

## 🌐 多语言支持

### 按钮文本
- 中文：票据
- 西班牙语：Ticket
- 英语：Ticket

### 标题文本
- 中文：票据 TICKET
- 西班牙语：TICKET
- 英语：TICKET

### 应用标题
- 中文：客户票据
- 西班牙语：Ticket para Clientes
- 英语：Customer Ticket

---

## ⚙️ 技术实现

### HTML 结构
```html
<button id="btn-mode-ticket" class="btn btn-mode" onclick="switchMode('ticket')">
  <svg>🎫 票据图标</svg>
  <span data-i18n="btnModeTicket">票据</span>
</button>
```

### JavaScript 逻辑
```javascript
// 模式切换函数
window.switchMode = function(mode) {
    currentMode = mode;
    
    // 更新按钮状态
    document.getElementById('btn-mode-ticket').classList.toggle('active', mode === 'ticket');
    
    // 更新页面模式类
    const paper = document.getElementById('invoice-paper');
    paper.classList.remove('quote-mode', 'ticket-mode');
    if (mode === 'ticket') {
        paper.classList.add('ticket-mode');
    }
    
    // 更新标题
    if (mode === 'ticket') {
        appTitle.textContent = t('appTitleTicket');
        invoiceTitle.textContent = t('invoiceTitleTicket');
    }
}
```

### CSS 样式
```css
/* 票据模式下隐藏批发信息 */
.ticket-mode .bill-only {
  display: none !important;
}
```

---

## 📁 修改的文件

### 1. **HTML** (`index.html`)
- ✅ 添加票据模式按钮
- ✅ 添加票据图标

### 2. **JavaScript** (`js/main.js`)
- ✅ 更新 `switchMode()` 函数
- ✅ 添加票据模式逻辑
- ✅ 更新按钮状态管理

### 3. **CSS** (`css/style.css`)
- ✅ 添加 `.ticket-mode .bill-only` 隐藏规则

### 4. **多语言** (`js/i18n.js`)
- ✅ 添加中文翻译
- ✅ 添加西班牙语翻译
- ✅ 添加英语翻译

---

## 🎯 设计原则

### 1. **一致性**
- 与现有模式切换机制保持一致
- 使用相同的UI组件和交互方式

### 2. **简洁性**
- 只显示必要信息
- 避免冗余内容

### 3. **专业性**
- 票据化设计风格
- 清晰的信息层级

### 4. **实用性**
- 满足实际业务需求
- 便于打印和存档

---

## 🚀 快速上手

### 使用步骤
1. **完成交易** - 客户付款后
2. **切换模式** - 点击"票据"按钮
3. **检查内容** - 确认显示信息正确
4. **打印票据** - 点击"打印"按钮
5. **交付客户** - 作为付款凭证

### 注意事项
- ✅ 票据模式基于当前数据生成
- ✅ 切换模式不会修改原始数据
- ✅ 所有信息都完整保存在系统中
- ✅ 可随时切换回其他模式

---

## 🎁 额外价值

### 1. **业务流程完善**
- 补全了从报价→账单→票据的完整流程
- 每个环节都有对应的专用模式

### 2. **客户体验提升**
- 已付款客户提供专业票据
- 增强信任感和专业形象

### 3. **财务管理便利**
- 票据标准化
- 便于归档和查询
- 符合财务规范

---

## 📊 未来扩展

### 可能的增强功能
1. **票据编号** - 自动生成唯一票据号
2. **付款方式标注** - 显示具体付款方式
3. **二维码票据** - 生成可扫描的电子票据
4. **邮件发送** - 直接发送电子票据给客户

---

## 📝 总结

票据模式的添加完善了系统的业务流程：

```
潜在客户 → 报价模式 → 达成交易
    ↓
已付款客户 → 票据模式 → 付款凭证
    ↓
合作伙伴 → 账单模式 → 结算凭证
```

---

**版本：** 7.3.6  
**更新日期：** 2025-12-06  
**开发团队：** FH Global

**🎉 享受全新的票据模式！**
